<Window x:Class="IoTDeviceManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="IoT Device Manager" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen">

	<Window.Resources>
		<!-- Style for Online Status -->
		<Style x:Key="OnlineStatusStyle" TargetType="TextBlock">
			<Setter Property="Foreground" Value="Green"/>
			<Setter Property="FontWeight" Value="Bold"/>
			<Style.Triggers>
				<DataTrigger Binding="{Binding IsOnline}" Value="False">
					<Setter Property="Foreground" Value="Red"/>
				</DataTrigger>
			</Style.Triggers>
		</Style>

		<!-- Button Style -->
		<Style TargetType="Button">
			<Setter Property="Margin" Value="5"/>
			<Setter Property="Padding" Value="10,5"/>
			<Setter Property="MinWidth" Value="100"/>
		</Style>
	</Window.Resources>

	<Grid Margin="10">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="250"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<!-- Header Section -->
		<Border Grid.Row="0" Background="#2C3E50" Padding="15" Margin="0,0,0,10">
			<StackPanel>
				<TextBlock Text="IoT Device Manager"
                          FontSize="24"
                          FontWeight="Bold"
                          Foreground="White"/>
				<TextBlock Text="Real-time Device Monitoring and Management System"
                          FontSize="12"
                          Foreground="#BDC3C7"
                          Margin="0,5,0,0"/>
			</StackPanel>
		</Border>

		<!-- Main Content Area -->
		<Grid Grid.Row="1">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*"/>
				<ColumnDefinition Width="Auto"/>
			</Grid.ColumnDefinitions>

			<!-- Device List Section -->
			<GroupBox Header="Device List" Grid.Column="0" Margin="0,0,5,0">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="*"/>
					</Grid.RowDefinitions>

					<!-- Action Buttons -->
					<StackPanel Orientation="Horizontal" Grid.Row="0" Margin="5">
						<Button Content="➕ Add Device"
                                Command="{Binding AddDeviceCommand}"
                                Background="#27AE60"
                                Foreground="White"/>
						<Button Content="✏️ Edit Device"
                                Command="{Binding EditDeviceCommand}"
                                Background="#3498DB"
                                Foreground="White"/>
						<Button Content="🗑️ Delete Device"
                                Command="{Binding DeleteDeviceCommand}"
                                Background="#E74C3C"
                                Foreground="White"/>
						<Button Content="🔄 Toggle Status"
                                Command="{Binding ToggleStatusCommand}"
                                Background="#F39C12"
                                Foreground="White"/>
						<Button Content="🔃 Refresh"
                                Command="{Binding RefreshCommand}"
                                Background="#95A5A6"
                                Foreground="White"/>
					</StackPanel>

					<!-- DataGrid for Devices -->
					<DataGrid Grid.Row="1"
                             ItemsSource="{Binding Devices}"
                             SelectedItem="{Binding SelectedDevice}"
                             AutoGenerateColumns="False"
                             IsReadOnly="True"
                             SelectionMode="Single"
                             CanUserAddRows="False"
                             GridLinesVisibility="Horizontal"
                             AlternatingRowBackground="#ECF0F1"
                             Margin="5">
						<DataGrid.Columns>
							<DataGridTextColumn Header="Device ID"
                                              Binding="{Binding Id}"
                                              Width="80"/>
							<DataGridTextColumn Header="Name"
                                              Binding="{Binding Name}"
                                              Width="*"/>
							<DataGridTextColumn Header="Type"
                                              Binding="{Binding Type}"
                                              Width="150"/>
							<DataGridTemplateColumn Header="Status" Width="80">
								<DataGridTemplateColumn.CellTemplate>
									<DataTemplate>
										<TextBlock Text="{Binding Status}"
                                                  Style="{StaticResource OnlineStatusStyle}"
                                                  HorizontalAlignment="Center"/>
									</DataTemplate>
								</DataGridTemplateColumn.CellTemplate>
							</DataGridTemplateColumn>
							<DataGridTextColumn Header="IP Address"
                                              Binding="{Binding IpAddress}"
                                              Width="120"/>
							<DataGridTextColumn Header="Temperature"
                                              Binding="{Binding Temperature, StringFormat={}{0:F1}°C}"
                                              Width="100"/>
							<DataGridTextColumn Header="Location"
                                              Binding="{Binding Location}"
                                              Width="200"/>
							<DataGridTextColumn Header="Last Seen"
                                              Binding="{Binding LastSeen, StringFormat={}{0:HH:mm:ss}}"
                                              Width="100"/>
						</DataGrid.Columns>
					</DataGrid>
				</Grid>
			</GroupBox>

			<!-- Device Details Panel -->
			<GroupBox Header="Device Details" Grid.Column="1" Width="300" Margin="5,0,0,0">
				<ScrollViewer VerticalScrollBarVisibility="Auto">
					<StackPanel Margin="10">
						<TextBlock Text="Select a device to view details"
                                  FontStyle="Italic"
                                  Foreground="Gray"
                                  TextWrapping="Wrap">
							<TextBlock.Style>
								<Style TargetType="TextBlock">
									<Setter Property="Visibility" Value="Collapsed"/>
									<Style.Triggers>
										<DataTrigger Binding="{Binding SelectedDevice}" Value="{x:Null}">
											<Setter Property="Visibility" Value="Visible"/>
										</DataTrigger>
									</Style.Triggers>
								</Style>
							</TextBlock.Style>
						</TextBlock>

						<StackPanel>
							<StackPanel.Style>
								<Style TargetType="StackPanel">
									<Setter Property="Visibility" Value="Visible"/>
									<Style.Triggers>
										<DataTrigger Binding="{Binding SelectedDevice}" Value="{x:Null}">
											<Setter Property="Visibility" Value="Collapsed"/>
										</DataTrigger>
									</Style.Triggers>
								</Style>
							</StackPanel.Style>

							<TextBlock Text="Device ID:" FontWeight="Bold" Margin="0,5,0,2"/>
							<TextBlock Text="{Binding SelectedDevice.Id}" Margin="0,0,0,10"/>

							<TextBlock Text="Name:" FontWeight="Bold" Margin="0,5,0,2"/>
							<TextBlock Text="{Binding SelectedDevice.Name}"
                                      TextWrapping="Wrap" Margin="0,0,0,10"/>

							<TextBlock Text="Type:" FontWeight="Bold" Margin="0,5,0,2"/>
							<TextBlock Text="{Binding SelectedDevice.Type}" Margin="0,0,0,10"/>

							<TextBlock Text="Status:" FontWeight="Bold" Margin="0,5,0,2"/>
							<TextBlock Text="{Binding SelectedDevice.Status}"
                                      Style="{StaticResource OnlineStatusStyle}"
                                      Margin="0,0,0,10"/>

							<TextBlock Text="IP Address:" FontWeight="Bold" Margin="0,5,0,2"/>
							<TextBlock Text="{Binding SelectedDevice.IpAddress}" Margin="0,0,0,10"/>

							<TextBlock Text="Firmware Version:" FontWeight="Bold" Margin="0,5,0,2"/>
							<TextBlock Text="{Binding SelectedDevice.FirmwareVersion}" Margin="0,0,0,10"/>

							<TextBlock Text="Temperature:" FontWeight="Bold" Margin="0,5,0,2"/>
							<TextBlock Text="{Binding SelectedDevice.Temperature, StringFormat={}{0:F1}°C}"
                                      Margin="0,0,0,10"/>

							<TextBlock Text="Location:" FontWeight="Bold" Margin="0,5,0,2"/>
							<TextBlock Text="{Binding SelectedDevice.Location}"
                                      TextWrapping="Wrap" Margin="0,0,0,10"/>

							<TextBlock Text="Last Seen:" FontWeight="Bold" Margin="0,5,0,2"/>
							<TextBlock Text="{Binding SelectedDevice.LastSeen, StringFormat={}{0:yyyy-MM-dd HH:mm:ss}}"
                                      Margin="0,0,0,10"/>
						</StackPanel>
					</StackPanel>
				</ScrollViewer>
			</GroupBox>
		</Grid>

		<!-- Activity Log Section -->
		<GroupBox Header="Activity Log" Grid.Row="2" Margin="0,10,0,0">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="*"/>
				</Grid.RowDefinitions>

				<Button Content="🗑️ Clear Logs"
                       Command="{Binding ClearLogsCommand}"
                       HorizontalAlignment="Right"
                       Margin="5"
                       Grid.Row="0"/>

				<DataGrid Grid.Row="1"
                         ItemsSource="{Binding Logs}"
                         AutoGenerateColumns="False"
                         IsReadOnly="True"
                         GridLinesVisibility="Horizontal"
                         AlternatingRowBackground="#ECF0F1"
                         Margin="5">
					<DataGrid.Columns>
						<DataGridTextColumn Header="Timestamp"
                                          Binding="{Binding Timestamp, StringFormat={}{0:yyyy-MM-dd HH:mm:ss}}"
                                          Width="150"/>
						<DataGridTextColumn Header="Level"
                                          Binding="{Binding LogLevel}"
                                          Width="80"/>
						<DataGridTextColumn Header="Action"
                                          Binding="{Binding Action}"
                                          Width="150"/>
						<DataGridTextColumn Header="Device"
                                          Binding="{Binding DeviceName}"
                                          Width="200"/>
						<DataGridTextColumn Header="Details"
                                          Binding="{Binding Details}"
                                          Width="*"/>
					</DataGrid.Columns>
				</DataGrid>
			</Grid>
		</GroupBox>

		<!-- Status Bar -->
		<StatusBar Grid.Row="3" Margin="0,5,0,0">
			<StatusBarItem>
				<TextBlock Text="{Binding StatusMessage}" FontWeight="Bold"/>
			</StatusBarItem>
			<Separator/>
			<StatusBarItem>
				<TextBlock>
					<Run Text="Total Devices: "/>
					<Run Text="{Binding Devices.Count, Mode=OneWay}" FontWeight="Bold"/>
				</TextBlock>
			</StatusBarItem>
			<Separator/>
			<StatusBarItem>
				<TextBlock>
					<Run Text="Online: "/>
					<Run Text="{Binding Devices.Count, Mode=OneWay}" FontWeight="Bold" Foreground="Green"/>
				</TextBlock>
			</StatusBarItem>
		</StatusBar>
	</Grid>
</Window>